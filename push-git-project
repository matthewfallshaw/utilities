#!/bin/bash
host=git.trike.com.au

function usage () {
   cat <<EOF
Usage: $progname [-h hostname] [project=pwd]
EOF
   exit 0
}

while getopts "h:" opt; do
  case $opt in
    h ) host=$OPTARG ;;
    \?) usage;;
  esac
done
shift $(($OPTIND - 1))

if [ -z $1 ]; then
  project=`basename \`pwd\``
else
  project=$1
fi

ssh git@$host "cd projectfiles; umask 2; mkdir $project.git; cd $project.git; git --bare init"
git remote add origin git@$host:projectfiles/$project.git
git push origin master
echo
echo "Project pushed to:"
git remote show origin
